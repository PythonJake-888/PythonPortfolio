{% extends "base.html" %}
{% block content %}
<div class="admin-shell">

  <!-- Top Bar -->
  <div class="admin-topbar">
    <span>Logged in as {{ current_user.username }}</span>
    <form method="POST" action="{{ url_for('logout') }}">
      <button class="btn btn-sm">Logout</button>
    </form>
  </div>

  <h1 class="admin-title">Admin Dashboard</h1>

  <!-- ADD PROJECT -->
  <section class="admin-section">
    <h2>Add Project</h2>

    <form method="POST" action="{{ url_for('add_project') }}" class="admin-form admin-grid">
      <input name="title" placeholder="Title" required>
      <textarea name="description" placeholder="Description"></textarea>

      <input name="tech" placeholder="Tech stack">
      <input name="github" placeholder="GitHub URL">
      <input name="demo_url" placeholder="Live demo URL">

<div class="admin-checkbox">
  <label>
    <input type="checkbox" name="has_demo">
    Has Live Demo
  </label>
</div>


      <button class="btn btn-primary admin-submit">Create Project</button>
    </form>
  </section>

  <!-- PROJECTS -->
  <section class="admin-section">
    <h2>Projects</h2>

    <div class="admin-project-grid">
    {% for project in projects %}
      <div class="admin-project-card">

        <h3>{{ project.title }}</h3>
        <p>{{ project.description }}</p>

        <form method="POST"
              action="{{ url_for('upload_project_media', project_id=project.id) }}"
              enctype="multipart/form-data">

          <input type="file" name="file" required>

          <div class="project-actions">
            <a href="{{ url_for('edit_project', id=project.id) }}" class="btn btn-outline">Edit</a>
            <button class="btn btn-primary">Upload Media</button>
          </div>
        </form>

        <div class="admin-media-grid">
          {% for media in project.media %}
            {% if media.media_type == "video" %}
              <video src="{{ media.url }}" muted></video>
            {% else %}
              <img src="{{ media.url }}" onclick="openLightbox('{{ media.url }}','image')">
            {% endif %}
          {% endfor %}
        </div>

        <form method="POST" action="{{ url_for('delete_project', id=project.id) }}">
          <button class="btn btn-delete">Delete Project</button>
        </form>

      </div>
    {% endfor %}
    </div>
  </section>

  <!-- BLOG -->
  <section class="admin-section">
    <h2>Add Blog Post</h2>

    <form method="POST" action="{{ url_for('add_blog') }}" class="admin-form">
      <input name="title" placeholder="Post title" required>
      <textarea name="body" placeholder="Post content" rows="6"></textarea>
      <button class="btn">Publish</button>
    </form>

    <h2>Blog Posts</h2>
    {% for post in posts %}
      <div class="admin-blog-row">
        <span>{{ post.title }}</span>

        <div class="admin-actions">
          <a href="{{ url_for('edit_blog', id=post.id) }}" class="btn">Edit</a>
          <form method="POST" action="{{ url_for('delete_blog', id=post.id) }}">
            <button class="btn btn-delete">Delete</button>
          </form>
        </div>
      </div>
    {% endfor %}
  </section>

</div>
{% endblock %}
